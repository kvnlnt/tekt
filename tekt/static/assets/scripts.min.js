var ARK={};ARK.TEKTONIK="http://127.0.0.1:5001/v1_0",ARK.Autoload=function(module){return module.view=function(selector,view,makeSelectorEl){var makeSelectorEl=makeSelectorEl||!1;$(document).on("ready",function(){var els=$(selector);els.length&&els.each(function(i,container){var config=makeSelectorEl?{el:selector}:{},v=new view(config);v.container=container})})},module}(ARK.Autoloader||{}),ARK.Log=function(){console&&console.log.apply(console,arguments)},ARK.Messenger=function(){console&&console.log.apply(console,arguments)},ARK.Prompt=function(message){var p=prompt(message);return p},ARK.pubsub=_.extend({},Backbone.Events),ARK.Template=function(source,data){var template=_.template(source),compiled=template(data);return compiled},ARK.Properties_page_list=function(){var listCollection=new ARK.Properties,listView=new ARK.Properties_part_list({collection:listCollection}),createView=new ARK.Properties_part_create({collection:listCollection});return{listView:listView,listCollection:listCollection,createView:createView}},ARK.Properties_part_create=Backbone.View.extend({el:".properties_part_create",events:{"click .save":"save"},initialize:function(){this.createForm=this.$el.find("form")},save:function(e){e.preventDefault();var that=this,data=this.createForm.serializeJSON(),model=new ARK.Property,success=function(model){that.collection.add(model)},error=function(model,xhr){console.log(xhr)};model.save(data,{wait:!0,success:success,error:error}),this.createForm.trigger("reset")}}),ARK.Properties_part_list_item=Backbone.View.extend({tagName:"li",className:"properties_part_list_item",events:{"click .delete":"delete"},"delete":function(){return this.remove(),this.model.destroy({wait:!0}),this},render:function(){var template=ARK.Template(ARK.Properties_piece_list_item,this.model.toJSON());return this.$el.html(template),this}}),ARK.Properties_part_list=Backbone.View.extend({el:".properties_part_list",items:{},initialize:function(){this.collection.bind("reset",this.addAll,this),this.collection.bind("add",this.addOne,this),this.collection.bind("error",this.error,this),this.collection.fetch({reset:!0})},error:function(model,xhr){var message=xhr.responseJSON.error;console.log(message)},addOne:function(model){var config={model:model},item=new ARK.Properties_part_list_item(config);this.renderItem(item),this.items[model.cid]=item},addAll:function(){this.$el.empty(),_.each(this.collection.models,this.addOne,this),this.render()},renderItem:function(item){this.$el.append(item.render().el)},render:function(){return $(this.container).html(this.el),this}}),ARK.Properties_piece_list_item='<%= id %> / <%= property %> / <a class="delete">delete</a>',ARK.Property=Backbone.Model.extend({urlRoot:ARK.TEKTONIK+"/properties"}),ARK.Properties=Backbone.Collection.extend({url:ARK.TEKTONIK+"/properties",model:ARK.Property,parse:function(response){return response.results}});
//# sourceMappingURL=scripts.min.js.map