var ARK={};ARK.errors=function(module){return module.RequirementError=function(message){this.message=message,this.name="RequirementError"},module.RequirementError.prototype=Object.create(Error.prototype),module}(ARK.errors||{}),ARK.back_to_top=function(module){return module.el="#top",module.delay=150,module.manage=function(){module.$win.scrollTop()>=50?module.$el.fadeIn(200):module.$el.fadeOut(200)},module.scrollTop=function(){module.$body.animate({scrollTop:0},500)},module.init=function(){module.$win=$(window),module.$body=$("body, html"),module.$el=$(module.el),module.$el.on("click",module.scrollTop),module.$win.on("scroll",_.debounce(module.manage,module.delay))},$(document).ready(module.init),module}(ARK.back_to_top||{}),ARK.cookies=function(module){return module.name="ARK",module.json={},module.set=function(key,val,path){key=module.name+"."+key,val=val||"",path=path||"/",$.cookie(key,val,{path:path})},module.default=function(key,val,path){void 0===$.cookie(module.name+"."+key)&&module.set(key,val,path)},module.get=function(key){return key=module.name+"."+key,$.cookie(key)},module}(ARK.cookies||{}),ARK.menus=function(module){return module.el={},module.el.menu="#menu",module.el.toggle="#menu-toggle",module.collapse_key="menu-toggle",module.toggle=function(){module.el.$menu.toggleClass("collapsed");var btn=module.el.$toggle.children(".fa");btn.hasClass("fa-chevron-left")?btn.removeClass("fa-chevron-left").addClass("fa-chevron-right"):btn.removeClass("fa-chevron-right").addClass("fa-chevron-left");var collapsed="true"===ARK.cookies.get(module.collapse_key)?"false":"true";ARK.cookies.set(module.collapse_key,collapsed)},module.init=function(){module.el.$menu=$(module.el.menu),module.el.$toggle=$(module.el.toggle),module.el.$toggle.click(module.toggle),ARK.cookies.default(module.collapse_key,"false")},module.init(),module}(ARK.menus||{}),ARK.Selector=function(config){var defaults={key:null,val:null,el:null,endpoint:null,target:null,callback:null,delay:500,minlength:2,suggestion_template:"<%= suggestion.id %>",suggestions_wrapper:null};if(this.settings=_.assign(defaults,config),this.key=this.settings.key,this.attr_key="ark-key",this.val=this.settings.val,this.attr_val="ark-val",this.term="",this.el=this.settings.el,this.endpoint=this.settings.endpoint,this.delay=this.settings.delay,this.minlength=this.settings.minlength,this.callback=this.settings.callback,this.target=this.settings.target,null===this.key)throw new ARK.errors.RequirementError("key is required");if(null===this.val)throw new ARK.errors.RequirementError("val is required");if(null===this.el)throw new ARK.errors.RequirementError("el is required");if(null===this.endpoint)throw new ARK.errors.RequirementError("endpoint is required");if(null===this.target)throw new ARK.errors.RequirementError("target is required");if(!1==this.el instanceof jQuery)throw TypeError("el must be a jquery object");return this.template_string="<ul><% _.forEach(suggestions, function(suggestion) { %><li><a "+this.attr_key+'="<%= suggestion.'+this.key+' %>" '+this.attr_val+'="<%= suggestion.'+this.val+' %>">'+this.settings.suggestion_template+"</a></li><% }); %></ul>",this.template=_.template(this.template_string),this.search=function(){var field=this.el,term=field.val(),url=this.endpoint+term;if(term===this.term)return!1;this.target.val(0),this.el.removeClass("legit");var suggestions=term.length<this.minlength?[]:this.fetch(url);this.render(suggestions,term),this.term=term},this.fetch=function(url){var ajax={url:url,type:"GET",async:!1,context:this},response=$.ajax(ajax).responseJSON;return response.result},this.render=function(suggestions,term){if(term.length>this.minlength?this.settings.suggestions_wrapper.show():this.settings.suggestions_wrapper.hide(),suggestions.length>0){var template=this.template({suggestions:suggestions});this.settings.suggestions_wrapper.html(template)}else this.settings.suggestions_wrapper.html('no results for "'+term+'"')},this.selected=function(e){e.stopPropagation(),e.preventDefault(),e.stopImmediatePropagation();var scope=e.data.context,key=$(this).attr(scope.attr_key),val=$(this).attr(scope.attr_val),result={};result[scope.key]=key,result[scope.val]=val,scope.target.val(key),scope.term=val,scope.el.val(val),scope.el.addClass("legit"),null!==scope.callback&&scope.callback(result),scope.settings.suggestions_wrapper.hide()},this.init=function(){this.el.on("keyup",_.debounce(this.search,this.delay).bind(this)),this.el.val(this.term),this.settings.suggestions_wrapper.on("click","a",{context:this},this.selected)},this.de_init=function(){this.settings.suggestions_wrapper.hide(),this.settings.suggestions_wrapper.html(""),this.el.off("keyup"),"0"===this.target.val()&&(this.el.val(""),this.term="")},this.el.on("focus",this.init.bind(this)),this.el.on("blur",_.debounce(this.de_init,100).bind(this)),this.init(),this},ARK.selectors=function(module){return module.collection=[],module.on_select=function(){},module.selectors=[{key:"id",val:"page",dom_selector:'[ark-selector="page"]',endpoint:"/pages/search/",target:"#page_id",suggestions_wrapper:'[ark-selector-suggestions="page"]',suggestion_template:"<%= suggestion.page %>"}],module.init=function(){_.each(module.selectors,function(v){var config={key:v.key,val:v.val,el:$(v.dom_selector),endpoint:v.endpoint,target:$(v.target),suggestions_wrapper:$(v.suggestions_wrapper),suggestion_template:v.suggestion_template},selector=new ARK.Selector(config);module.collection.push(selector)})},$(document).ready(module.init),module}(ARK.selectors||{});
//# sourceMappingURL=scripts.min.js.map