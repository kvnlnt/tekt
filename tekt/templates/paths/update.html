{% from "macros/forms.html" import render_field, render_hidden_field %} 
{% extends 'template.html' %} 

{% block body %}
<h1>
    <a black href="{{ url_for('.list_paths') }}">Paths</a>
</h1>
<form method="post" action="{{ url_for('paths.update_path', id=path.id) }}">
    {{ path_form.id }}
    <legend>Settings</legend>
    <fieldset>
        <ul class="list">
            {{ render_field(path_form.path, autofocus="autofocus", placeholder="Example: /my/path") }}
        </ul>
    </fieldset>
    <fieldset>
        <ul class="list">
            {{ render_field(path_form.property_id) }}
        </ul>
    </fieldset>
    <footer>
        <input class="button" type="submit" value="save">
        <a class="button" href="{{ url_for('paths.read_path', id=path.id) }}">cancel</a>
    </footer>
</form>

<div class="card">
    <header>
        <h2 class="title">Page Schedule</h2>
        <div class="actions"><a class="button" tekt-showhide="add_form_wrapper">Add</a></div>
    </header>
    <div class="drawer view-hidden" tekt-id="add_form_wrapper">
        <form id="add_page" method="post" action="{{ url_for('paths.update_path', id=path.id) }}" style="margin:10px 10px 0 10px;">
            <legend>Add Page</legend>
                <fieldset>
                    <ul class="list">
                        {{ render_hidden_field(page_form.path_id) }}
                        {{ render_hidden_field(page_form.page_id) }} 
                        {{ 
                            render_field(page_form.page_selector, 
                            placeholder=page_form.page_selector.description, 
                            readonly="readonly", 
                            **{'tekt-selector':'page', 'tekt-id':'page_selector'}) 
                        }}
                    </ul>
                </fieldset>
            <footer>
                <input class="button" type="submit" value="Add Page">
            </footer>
        </form>
    </div>
    <div class="content">
        <table class="data">
            <tr>
                <th>#</th>
                <th>page</th>
                <th>actions</th>
            </tr>
            {% for page in path.pages %}
            <tr>
                <td>{{ page.id }}</td>
                <td><a black href="{{ url_for('pages.read_page', id=page.id) }}">{{ page.page }}</a>
                </td>
                <td><a black href="{{ url_for('paths.remove_page_from_path', id=path.id, path_page_id=page.path_page_id)}}">remove</a>
                </td>
            </tr>
            {% endfor %}
        </table>
    </div>
</div>

<div class="panel text-right">
    <a class="alarm button link" tekt-showhide="delete_form">delete</a>
</div>

<form method="post" tekt-id="delete_form" class="view-hidden" action="{{ url_for('.delete_path', id=path.id) }}">
    <legend>Delete Path</legend>
    <fieldset>
        {{ delete_form.phrase }}
        <div class="field">
            {{ delete_form.confirm(placeholder=path_form.path.data)|safe }}
            <label>{{ delete_form.confirm.description }}</label>
        </div>
    </fieldset>
    <footer>
    <div class="actions">
        <input class="button alarm" type="submit" value="confirm">
    </footer>
</form>
{% endblock %}
